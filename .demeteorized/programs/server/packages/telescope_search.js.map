{"version":3,"sources":["telescope:search/lib/search.js","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/package-tap.i18n","telescope:search/lib/server/log_search.js","telescope:search/lib/server/publications.js","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/de.i18n.json","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/en.i18n.json","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/es.i18n.json","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/fr.i18n.json","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/it.i18n.json","telescope:search//Users/sacha/Dev/Telescope/packages/telescope-search/i18n/zh-CN.i18n.json"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uC;AACA,qC;AACA,qB;AACA,Y;AACA,G;;AAEA,oC;AACA,qB;AACA,U;AACA,G;;AAEA,oC;AACA,sB;AACA,uB;AACA,kD;AACA,G;;AAEA,+E;;AAEA,8C;AACA,4B;AACA,U;AACA,mB;AACA,oB;AACA,M;AACA,gB;AACA,gB;AACA,M;AACA,c;AACA,kB;AACA,K;AACA,I;AACA,G;;AAEA,2B;AACA,kB;AACA,8B;AACA,8B;AACA,K;AACA,G;;AAEA,8B;AACA,4D;AACA,sF;AACA,wD;AACA,2B;;AAEA,qE;AACA,W;AACA,Y;AACA,sD;AACA,oD;AACA,oD;AACA,O;AACA,K;AACA,K;AACA,oB;AACA,G;;;;;;;;;;;;;;;;;;;ACzDA,kH;;AAEA,+D;AACA,gD;;;;;;;;;;;;;;;;;;;ACHA,oC;AACA,mB;AACA,0B;AACA,oB;AACA,K;AACA,E;;AAEA,gB;AACA,iC;AACA,kC;AACA,G;AACA,G;;;;;;;;;;;;;;;;;;ACXA,4C;AACA,sB;AACA,sC;AACA,mE;AACA,G;AACA,Y;AACA,G;;;;;;;;;;;;;;;;;;;ACNA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,8F;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,gD;AACA,kB;AACA,2K;AACA,gD;;;;;;;;;;;;;;;;;;;ACVA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,gG;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,oG;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,+C;AACA,kC;AACA,C;;AAEA,0D;AACA,6C;AACA,C;;AAEA,iG;;;;;;;;;;;;;;;;;;;ACfA,6B;AACA,sC;AACA,mC;;AAEA,gC;AACA,yD;AACA,C;AACA,kD;AACA,qC;AACA,C;;AAEA,6D;AACA,gD;AACA,C;;AAEA,2F","file":"/packages/telescope_search.js","sourcesContent":["// push \"search\" template to primaryNav\nTelescope.modules.add(\"primaryNav\", {\n  template: 'search',\n  order: 100\n});\n\nTelescope.modules.add(\"mobileNav\", {\n  template: 'search',\n  order: 1\n});\n\nTelescope.modules.add(\"adminMenu\", {\n  route: 'searchLogs',\n  label: 'search_logs',\n  description: 'see_what_people_are_searching_for'\n});\n\nTelescope.colorElements.add('.search .search-field', 'secondaryContrastColor');\n\nSearches = new Meteor.Collection(\"searches\", {\n  schema: new SimpleSchema({\n    _id: {\n      type: String,\n      optional: true\n    },\n    timestamp: {\n      type: Date\n    },\n    keyword: {\n      type: String\n    }\n  })\n});\n\nMeteor.startup(function() {\n  Searches.allow({\n    update: Users.is.adminById\n  , remove: Users.is.adminById\n  });\n});\n\n// search post list parameters\nPosts.views.add(\"search\", function (terms, baseParameters) {\n  // if query is empty, just return parameters that will result in an empty collection\n  if(typeof terms.query === 'undefined' || !terms.query)\n    return {find:{_id: 0}};\n\n  var parameters = Telescope.utils.deepExtend(true, baseParameters, {\n    find: {\n      $or: [\n        {title: {$regex: terms.query, $options: 'i'}},\n        {url: {$regex: terms.query, $options: 'i'}},\n        {body: {$regex: terms.query, $options: 'i'}}\n      ]\n    }\n  });\n  return parameters;\n});\n","TAPi18n.packages[\"telescope:search\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n","var logSearch = function (keyword) {\n  Searches.insert({\n    timestamp: new Date(),\n    keyword: keyword\n  });\n};\n\nMeteor.methods({\n  logSearch: function (keyword) {\n    logSearch.call(this, keyword);\n  }\n});","Meteor.publish('searches', function(limit) {\n  limit = limit || 20;\n  if(Users.is.adminById(this.userId)){\n   return Searches.find({}, {limit: limit, sort: {timestamp: -1}});\n  }\n  return [];\n});\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"de\"])) {\n  TAPi18n.translations[\"de\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"de\"][namespace])) {\n  TAPi18n.translations[\"de\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"de\"][namespace], {\"load_more\":\"Mehr Laden\",\"search\":\"Suchen\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \ntranslations = {};\ntranslations[namespace] = {\"load_more\":\"Load more\",\"search\":\"Search\",\"search_logs\":\"Search Logs\",\"see_what_people_are_searching_for\":\"See what people are searching for.\"};\nTAPi18n._loadLangFileObject(\"en\", translations);\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"es\"])) {\n  TAPi18n.translations[\"es\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"es\"][namespace])) {\n  TAPi18n.translations[\"es\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"es\"][namespace], {\"load_more\":\"Cargar más\",\"search\":\"Búsqueda\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"fr\"])) {\n  TAPi18n.translations[\"fr\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"fr\"][namespace])) {\n  TAPi18n.translations[\"fr\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"fr\"][namespace], {\"load_more\":\"Charger plus\",\"search\":\"Rechercher\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"it\"])) {\n  TAPi18n.translations[\"it\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"it\"][namespace])) {\n  TAPi18n.translations[\"it\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"it\"][namespace], {\"load_more\":\"Carica altro\",\"search\":\"Ricerca\"});\n","var _ = Package.underscore._,\n    package_name = \"telescope:search\",\n    namespace = \"telescope:search\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\nif(_.isUndefined(TAPi18n.translations[\"zh-CN\"])) {\n  TAPi18n.translations[\"zh-CN\"] = {};\n}\n\nif(_.isUndefined(TAPi18n.translations[\"zh-CN\"][namespace])) {\n  TAPi18n.translations[\"zh-CN\"][namespace] = {};\n}\n\n_.extend(TAPi18n.translations[\"zh-CN\"][namespace], {\"load_more\":\"加载更多\",\"search\":\"Search\"});\n"]}