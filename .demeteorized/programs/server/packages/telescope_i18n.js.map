{"version":3,"sources":["telescope:i18n/i18n.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,U;;AAEA,kB;AACA,wC;AACA,qC;AACA,2C;;AAEA,W;AACA,oC;AACA,mC;AACA,wC;AACA,qC;AACA,U;AACA,8H;AACA,8B;AACA,uC;AACA,4C;AACA,sC;AACA,O;AACA,G;;AAEA,Y;AACA,qC;AACA,oC;AACA,+B;AACA,uB;AACA,wC;AACA,uC;AACA,O;;AAEA,Q;AACA,4B;AACA,E;;AAEA,kC;AACA,wB;AACA,oE;AACA,U;AACA,oC;AACA,G;AACA,E;;AAEA,uD;AACA,4B;;AAEA,2C;AACA,0B;AACA,uC;AACA,2F;AACA,sC;AACA,uC;AACA,S;AACA,2B;AACA,Q;AACA,K;AACA,K;AACA,c;AACA,E;;AAEA,4B;;AAEA,wB;AACA,qD;AACA,G;;AAEA,G","file":"/packages/telescope_i18n.js","sourcesContent":["i18n = {};\n\n// do this better:\ni18n.setLanguage = function (language) {\n  // Session.set('i18nReady', false);\n  // console.log('i18n loading… '+language)\n\n  // moment\n  Session.set('momentReady', false);\n  // console.log('moment loading…')\n  if (language.toLowerCase() === \"en\") {\n    Session.set('momentReady', true);\n  } else {\n    $.getScript(\"//cdnjs.cloudflare.com/ajax/libs/moment.js/2.5.1/lang/\" + language.toLowerCase() + \".js\", function (result) {\n      moment.locale(language);\n      Session.set('momentReady', true);\n      Session.set('momentLocale', language);\n      // console.log('moment loaded!')\n    });\n  }\n\n  // TAPi18n\n  Session.set(\"TAPi18nReady\", false);\n  // console.log('TAPi18n loading…')\n  TAPi18n.setLanguage(language)\n    .done(function () {\n      Session.set(\"TAPi18nReady\", true);\n      // console.log('TAPi18n loaded!')\n    });\n\n  // T9n\n  T9n.setLanguage(language);\n};\n\ni18n.t = function (str, options) {\n  if (Meteor.isServer) {\n    return TAPi18n.__(str, options, Settings.get('language', 'en'));\n  } else {\n    return TAPi18n.__(str, options);\n  }\n};\n\nSimpleSchema.prototype.internationalize = function () {\n  var schema = this._schema;\n\n  _.each(schema, function (property, key) {\n    if (!property.label) {\n      schema[key].label = function () {\n        // if property is nested (\"telescope.email\"), only consider the last part (\"email\")\n        if (key.indexOf(\".\") !== -1) {\n          key = _.last(key.split(\".\"));\n        }\n        return i18n.t(key);\n      };\n    }\n  });\n  return this;\n};\n\nMeteor.startup(function () {\n\n  if (Meteor.isClient) {\n    i18n.setLanguage(Settings.get('language', 'en'));\n  }\n\n});"]}