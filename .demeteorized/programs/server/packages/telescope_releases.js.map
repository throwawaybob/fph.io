{"version":3,"sources":["telescope:releases//Users/sacha/Dev/Telescope/packages/telescope-releases/package-tap.i18n","telescope:releases/lib/releases.js","telescope:releases/lib/server/publications.js","telescope:releases/lib/server/import_releases.js","telescope:releases//Users/sacha/Dev/Telescope/packages/telescope-releases/i18n/en.i18n.json"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oH;;AAEA,+D;AACA,gD;;;;;;;;;;;;;;;;;;;ACHA,6C;;AAEA,+B;AACA,6B;AACA,G;;AAEA,kD;;AAEA,4B;AACA,kB;AACA,+B;AACA,+B;AACA,8B;AACA,K;AACA,G;;;;;;;;;;;;;;;;;;;ACdA,6C;AACA,sC;AACA,gE;AACA,G;AACA,Y;AACA,G;;;;;;;;;;;;;;;;;;;ACLA,uC;AACA,kE;;AAEA,4C;;AAEA,mB;AACA,qB;AACA,0B;AACA,4B;AACA,iB;AACA,M;AACA,6B;;AAEA,U;;AAEA,mF;AACA,qE;;AAEA,G;AACA,E;;AAEA,4B;;AAEA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;AACA,0B;;AAEA,0F;AACA,4C;AACA,6D;AACA,G;;AAEA,G;;;;;;;;;;;;;;;;;;;ACxCA,6B;AACA,wC;AACA,qC;;AAEA,gC;AACA,yD;AACA,C;AACA,gD;AACA,kB;AACA,uF;AACA,gD","file":"/packages/telescope_releases.js","sourcesContent":["TAPi18n.packages[\"telescope:releases\"] = {\"translation_function_name\":\"__\",\"helper_name\":\"_\",\"namespace\":\"project\"};\n\n// define package's translation function (proxy to the i18next)\n__ = TAPi18n._getPackageI18nextProxy(\"project\");\n","Releases = new Meteor.Collection('releases');\n\nTelescope.modules.add(\"hero\", {\n  template: 'current_release'\n});\n\nTelescope.subscriptions.preload('currentRelease');\n\nMeteor.startup(function () {\n  Releases.allow({\n    insert: Users.is.adminById,\n    update: Users.is.adminById,\n    remove: Users.is.adminById\n  });\n});\n","Meteor.publish('currentRelease', function() {\n  if(Users.is.adminById(this.userId)){\n    return Releases.find({}, {sort: {createdAt: -1}, limit: 1});\n  }\n  return [];\n});\n","var importRelease = function (number) {\n  var releaseNotes = Assets.getText(\"releases/\" + number + \".md\");\n\n  if (!Releases.findOne({number: number})) {\n\n    var release = {\n      number: number,\n      notes: releaseNotes,\n      createdAt: new Date(),\n      read: false\n    };\n    Releases.insert(release);\n\n  } else {\n\n    // if release note already exists, update its content in case it's been updated\n    Releases.update({number: number}, {$set: {notes: releaseNotes}});\n\n  }\n};\n\nMeteor.startup(function () {\n\n  importRelease('0.11.0');\n  importRelease('0.11.1');\n  importRelease('0.12.0');\n  importRelease('0.13.0');\n  importRelease('0.14.0');\n  importRelease('0.14.1');\n  importRelease('0.14.2');\n  importRelease('0.14.3');\n  importRelease('0.15.0');\n  importRelease('0.20.5');\n  importRelease('0.20.5');\n\n  // if this is before the first run, mark all release notes as read to avoid showing them\n  if (!Events.findOne({name: 'firstRun'})) {\n    Releases.update({}, {$set: {read: true}}, {multi: true});\n  }\n\n});\n","var _ = Package.underscore._,\n    package_name = \"telescope:releases\",\n    namespace = \"telescope:releases\";\n\nif (package_name != \"project\") {\n    namespace = TAPi18n.packages[package_name].namespace;\n}\n// integrate the fallback language translations \ntranslations = {};\ntranslations[namespace] = {\"telescope_has_been_updated\":\"Telescope has been updated.\"};\nTAPi18n._loadLangFileObject(\"en\", translations);\n"]}